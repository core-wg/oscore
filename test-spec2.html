<h1 id="tests-specification-for-oscoap">Tests Specification for OSCOAP</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol style="list-style-type: decimal">
<li><a href="#notes">Notes</a></li>
<li><a href="#security-contexts-and-resources">Security Contexts and Resources</a>
<ol style="list-style-type: decimal">
<li><a href="#client-sec">Security Context A: Client</a></li>
<li><a href="#server-sec">Security Context B: Server</a></li>
<li><a href="#resources">Resources</a></li>
</ol></li>
<li><a href="#correct-oscoap-use">Correct OSCOAP use</a>
<ol style="list-style-type: decimal">
<li><a href="#get">GET test</a>
<ol style="list-style-type: decimal">
<li><a href="#test-1a">Test 1a</a></li>
<li><a href="#test-1b">Test 1b</a></li>
<li><a href="#test-2a">Test 2a</a></li>
<li><a href="#test-2b">Test 2b</a></li>
<li><a href="#test-3a">Test 3a</a></li>
<li><a href="#test-3b">Test 3b</a></li>
<li><a href="#test-4a">Test 4a</a></li>
<li><a href="#test-4b">Test 4b</a></li>
<li><a href="#test-5a">Test 5a</a></li>
<li><a href="#test-5b">Test 5b</a></li>
</ol></li>
<li><a href="#post">POST test</a>
<ol style="list-style-type: decimal">
<li><a href="#test-6a">Test 6a</a></li>
<li><a href="#test-6b">Test 6b</a></li>
</ol></li>
<li><a href="#put">PUT test</a>
<ol style="list-style-type: decimal">
<li><a href="#test-7a">Test 7a</a></li>
<li><a href="#test-7b">Test 7b</a></li>
<li><a href="#test-8a">Test 8a</a></li>
<li><a href="#test-8b">Test 8b</a></li>
</ol></li>
<li><a href="#del">DELETE test</a>
<ol style="list-style-type: decimal">
<li><a href="#test-9a">Test 9a</a></li>
<li><a href="#test-9b">Test 9b</a></li>
</ol></li>
</ol></li>
<li><a href="#incorrect-oscoap">Incorrect OSCOAP use</a>
<ol style="list-style-type: decimal">
<li><a href="#sec-context">Security Context not matching</a>
<ol style="list-style-type: decimal">
<li><a href="#test-10a">Test 10a</a></li>
<li><a href="#test-10b">Test 10b</a></li>
<li><a href="#test-11a">Test 11a</a></li>
<li><a href="#test-11b">Test 11b</a></li>
<li><a href="#test-12a">Test 12a</a></li>
<li><a href="#test-12b">Test 12b</a></li>
</ol></li>
<li><a href="#replay">Replay of a previously sent message</a>
<ol style="list-style-type: decimal">
<li><a href="#test-13a">Test 13a</a></li>
<li><a href="#test-13b">Test 13b</a></li>
</ol></li>
<li><a href="#auth">Accessing an OSCOAP-protected resource without OSCOAP</a>
<ol style="list-style-type: decimal">
<li><a href="#test-14a">Test 14a</a></li>
<li><a href="#test-14b">Test 14b</a></li>
</ol></li>
</ol></li>
</ol>
<h2 id="notes">1. Notes</h2>
<p>CoAP Version is 2 in all the tests.</p>
<p>The client and server may optionally display external_aad and COSE object (before and after compression) to simplify debugging.</p>
<p>When non-indicated, CoAP messages can be NON or CON (implementer's choice)</p>
<h2 id="security-contexts-and-resources">2. Security Contexts and Resources</h2>
<h3 id="client-sec">Security Context A: Client</h3>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 01-02-03-04-05-06-07-08-09-0A-0B-0C-0D-0E-0F-10-11-12-13-14-15-16-17-18-19-1A-1B-1C-1D-1E-1F-20-21-22-23</li>
<li>Alg: AES-CCM-64-64-128</li>
</ul></li>
<li>Sender Context:
<ul>
<li>Sender Id: 63-6C-69-65-6E-74</li>
<li>Sender Key: 21-64-42-DA-60-3C-51-59-2D-F4-C3-D0-CD-1D-0D-48</li>
<li>Sender IV: 01-53-DD-FE-DE-44-19</li>
<li>Sender Seq Number: 00</li>
</ul></li>
<li>Recipient Context:
<ul>
<li>Recipient Id: 73-65-72-76-65-72</li>
<li>Recipient Key: D5-CB-37-10-37-15-34-A1-CA-22-4E-19-EB-96-E9-6D</li>
<li>Recipient IV: 20-75-0B-95-F9-78-C8</li>
</ul></li>
</ul>
<h3 id="server-sec">Security Context B: Server</h3>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 01-02-03-04-05-06-07-08-09-0A-0B-0C-0D-0E-0F-10-11-12-13-14-15-16-17-18-19-1A-1B-1C-1D-1E-1F-20-21-22-23</li>
<li>Alg: AES-CCM-64-64-128</li>
</ul></li>
<li>Sender Context:
<ul>
<li>Sender Id: 73-65-72-76-65-72</li>
<li>Sender Key: D5-CB-37-10-37-15-34-A1-CA-22-4E-19-EB-96-E9-6D</li>
<li>Sender IV: 20-75-0B-95-F9-78-C8</li>
<li>Sender Seq Number: 00</li>
</ul></li>
<li>Recipient Context:
<ul>
<li>Recipient Id: 63-6C-69-65-6E-74</li>
<li>Recipient Key: 21-64-42-DA-60-3C-51-59-2D-F4-C3-D0-CD-1D-0D-48</li>
<li>Recipient IV: 01-53-DD-FE-DE-44-19</li>
</ul></li>
</ul>
<h3 id="resources">Resources</h3>
<p>The list of resources the server must implement is the following:</p>
<ul>
<li>/hello/coap : authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
<li>/hello/2 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain), and with ETag 0x2b</li>
<li>/hello/3 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain), and Max-Age 5</li>
<li>/hello/6 : protected resource, authorized method: PUT, returns the value of the resource with content-format 0 (text/plain), has ETag 0x6b</li>
<li>/observe : protected resource, authorized method: GET, returns a counter incremented every 2 seconds, supports observe.</li>
</ul>
<hr />
<h2 id="set-up-the-environment">3. Set up the environment</h2>
<h3 id="test-0a">3.1. Identifier: TEST_0a</h3>
<p><strong>Objective</strong> : Verify that CoAP exchange works. Perform a simple GET transaction using COAP, Content-Format and Uri-Path option (Client side)</p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request including:</p>
<ul>
<li>Uri-Path : /hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing expected; expected: 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-0b">3.2. Identifier: TEST_0b</h4>
<p><strong>Objective</strong> : Verify that CoAP exchange works. Perform a simple GET transaction using COAP, Content-Format and Uri-Path option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/coap : authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request including:</p>
<ul>
<li>Uri-Path = /hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h2 id="correct-oscoap-use">4. Correct OSCOAP use</h2>
<h3 id="get">4.1 GET Tests</h3>
<h4 id="test-1a">4.1.1. Identifier: TEST_1a</h4>
<p><strong>Objective</strong> : Perform a simple GET transaction using OSCOAP, Content-Format and Uri-Path option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number received not in client's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-1b">4.1.2. Identifier: TEST_1b</h4>
<p><strong>Objective</strong> : Perform a simple GET transaction using OSCOAP, Content-Format and Uri-Path option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-2a">3.1.3. Identifier: TEST_2a</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, Uri-Query and ETag option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/2</li>
<li>Uri-Query : first=1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>ETag with value 0x2b</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-2b">3.1.4. Identifier: TEST_2b</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, Uri-Query and ETag option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/2 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain), and with ETag 0x2b</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /hello/2</li>
<li>Uri-Query : first=1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>ETag with value 0x2b</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-3a">3.1.5. Identifier: TEST_3a</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, Accept and Max-Age option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /hello/3</li>
<li>Accept = 0 (text/plain;charset=utf-8)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Max-Age with value 0x05</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-3b">3.1.6. Identifier: TEST_3b</h4>
<p><strong>Objective</strong> :Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, Accept and Max-Age option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/3 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain), and Max-Age 5</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /hello/3</li>
<li>Accept = 0 (text/plain;charset=utf-8)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Max-Age with value 0x05</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-4a">3.1.7. Identifier: TEST_4a</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, and Observe. Response without observe. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /hello/1</li>
<li>Observe = 0 (Registration)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-4b">3.1.8. Identifier: TEST_4b</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, and Observe. Response without observe. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li><ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul></li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /hello/1</li>
<li>Observe = 0 (Registration)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-5a">3.1.9. Identifier: TEST_5a</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, and Observe (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
<li>Sequence number received not in client's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /observe</li>
<li>Observe = 0 (Registration)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Observe (Notification)</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>6</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Observe (Notification)</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>7</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<p>Etc.</p>
<h4 id="test-5b">3.1.10. Identifier: TEST_5b</h4>
<p><strong>Objective</strong> : Perform a GET transaction using OSCOAP, Content-Format, Uri-Path, and Observe (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
<li>Sequence sent received not in client's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/observe : protected resource, authorized method: GET, returns a counter incremented every 2 seconds, supports observe.</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-path = /observe</li>
<li>Observe = 0 (Registration)</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Observe (Notification)</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>6</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Observe (Notification)</li>
<li>Payload = ...</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>7</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<p>Etc.</p>
<h3 id="post">3.2. POST Tests</h3>
<h4 id="test-6a">3.2.1. Identifier: TEST_6a</h4>
<p><strong>Objective</strong> : Perform a POST transaction using OSCOAP, Content-Format, Location-path, Location-Query and Uri-Path option, creating a resource (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP POST request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/6</li>
<li>Content-Format = 0</li>
<li>payload = 0x4a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.01 Created Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Location-path = /hello/6</li>
<li>Location-Query : first=1</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-6b">3.2.2. Identifier: TEST_6b</h4>
<p><strong>Objective</strong> : Perform a POST transaction using OSCOAP, Content-Format, Location-path, Location-Query and Uri-Path option, creating a resource (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP POST request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/6</li>
<li>Content-Format = 0</li>
<li>payload = 0x4a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.01 Created Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Location-path = /hello/6</li>
<li>Location-Query : first=1</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h3 id="PUT">3.3 PUT Tests</h3>
<h4 id="test-7a">3.3.1. Identifier: TEST_7a</h4>
<p><strong>Objective</strong> : Perform a PUT transaction using OSCOAP, Uri-Path, Content-Format and If-Match option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP PUT request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/7</li>
<li>Content-Format = 0</li>
<li>If-Match with value 0x7b</li>
<li>payload = 0x7a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-7b">3.3.2. Identifier: TEST_7b</h4>
<p><strong>Objective</strong> : Perform a PUT transaction using OSCOAP, Uri-Path, Content-Format and If-Match option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/7 : protected resource, authorized method: PUT, returns the value of the resource with content-format 0 (text/plain), has ETag 0x7b</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP PUT request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/7</li>
<li>Content-Format = 0</li>
<li>If-Match with value 0x7b</li>
<li>payload = 0x7a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-8a">3.3.3. Identifier: TEST_8a</h4>
<p><strong>Objective</strong> : Perform a PUT transaction using OSCOAP, Uri-Path, Content-Format and If-None-Match option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP PUT request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/7</li>
<li>Content-Format = 0</li>
<li>If-None-Match</li>
<li>payload = 0x7a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 4.12 Precondition Failed Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-8b">3.3.4. Identifier: TEST_8b</h4>
<p><strong>Objective</strong> : Perform a PUT transaction using OSCOAP, Uri-Path, Content-Format and If-None-Match option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/7 : protected resource, authorized method: PUT, returns the value of the resource with content-format 0 (text/plain), has ETag 0x7b</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP PUT request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /hello/7</li>
<li>Content-Format = 0</li>
<li>If-None-Match</li>
<li>payload = 0x8a</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 4.12 Precondition Failed Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h3 id="DEL">3.4. DELETE Tests</h3>
<h4 id="test-9a">3.4.1. Identifier: TEST_9a</h4>
<p><strong>Objective</strong> : Perform a DELETE transaction using OSCOAP and Uri-Path option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number sent not in server's replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP DEL request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /test</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.02 Deleted Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-9b">3.4.2. Identifier: TEST_9b</h4>
<p><strong>Objective</strong> : Perform a DELETE transaction using OSCOAP and Uri-Path option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server's replay window</li>
</ul>
<p><em>server resources</em>:</p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP DEL request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /test</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.02 Deleted Response with:</p>
<ul>
<li>Object-Security option</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h2 id="incorrect-oscoap">4. Incorrect OSCOAP use</h2>
<h3 id="sec-context">4.1. Security Context not matching</h3>
<h4 id="test-10a">4.1.1. Identifier: TEST_10a</h4>
<p><strong>Objective</strong> : Perform an unauthorized CON GET transaction: non matching Client Sender Id - Server Recipient Id (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sender Context:
<ul>
<li>Sender ID: modified sender ID (arbitrarily set by the Client)</li>
</ul></li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option (modified Sender ID)</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response : OSCOAP verification succeeds; expected response: 4.01 Unauthorized error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload: Security context not found (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-10b">4.1.2. Identifier: TEST_10b</h4>
<p><strong>Objective</strong> :Perform an unauthorized GET transaction: non matching Client Sender Id - Server Recipient Id (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a></p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option (modified Sender ID)</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>The message verification [7.2] fails and the server sends an error back (stop CoAP processing)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 4.01 Unauthorized error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload: Security context not found (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-11a">4.1.3. Identifier: TEST_11a</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction with non matching Client Sender - Server Recipient Keys (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sender Context:
<ul>
<li>Sender Key: modified key (arbitrarily set by the Client)</li>
</ul></li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response : OSCOAP verification succeeds; expected response: 4.00 Bad Request error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload: Decryption failed (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-11b">4.1.4. Identifier: TEST_11b</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction with non matching Client Sender - Server Recipient Keys (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a></p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>The message verification [7.2] fails and the server sends an error back (stop CoAP processing)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 4.00 Bad Request error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload: Decryption failed (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-12a">4.1.5. Identifier: TEST_12a</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction with non matching Client Recipient - Server Sender Keys (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Recipient Context:
<ul>
<li>Recipient Key: modified key (arbitrarily set by the Client)</li>
</ul></li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response : OSCOAP verification failure [7.4]; response dropped empty ACK sent back to the server</p></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-12b">4.1.6. Identifier: TEST_12b</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction with non matching Client Recipient - Server Sender Keys (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a></p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h3 id="replay">4.2. Replay of a previously sent message</h3>
<h4 id="test-13a">4.2.1. Identifier: TEST_13a</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction using OSCOAP, Content-Format and Uri-Path option, request replayed by the Client (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a></p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>6</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to reset its own sequence number to the value before executing step 1</p></td>
</tr>
<tr class="odd">
<td><p>7</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>8</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>9</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>10</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response and continues the CoAP processing (OSCOAP verification succeeds); expected: 4.00 Bad Request error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload = Replay protection failed (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>11</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-13b">4.2.2. Identifier: TEST_13b</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction using OSCOAP, Content-Format and Uri-Path option, request replayed by the Client (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context B</a></p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/1 : protected resource, authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and continues the CoAP processing (OSCOAP verification succeeds)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Object-Security option</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = &quot;Hello World!&quot;</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>6</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to reset its own sequence number to the value before executing step 1</p></td>
</tr>
<tr class="odd">
<td><p>7</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>The message verification [6.2] fails and the server sends an error back (stop CoAP processing)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 4.00 Bad Request error message:</p>
<ul>
<li>Object-Security option</li>
<li>Payload = Replay protection failed (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
<h3 id="auth">4.3. Accessing a non-OSCOAP-protected resource with OSCOAP</h3>
<h4 id="test-14a">4.3.1. Identifier: TEST_14a</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction using OSCOAP to a non protected resource, Content-Format and Uri-Path option (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a></p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request protected with OSCOAP, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Client serializes the request</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the sent packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Client parses the response : OSCOAP verification failure [7.4]; response dropped empty ACK sent back to the server</p></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Client displays the received packet</p></td>
</tr>
</tbody>
</table>
<h4 id="test-14b">4.3.2. Identifier: TEST_14b</h4>
<p><strong>Objective</strong> : Perform a CON GET transaction using OSCOAP to a non protected resource, Content-Format and Uri-Path option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p>The server does not implement OSCOAP.</p>
<p><em>server security context</em>: None</p>
<p><em>server resources</em>:</p>
<ul>
<li>/hello/coap : authorized method: GET, returns the string &quot;Hello World!&quot; with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1</p></td>
<td><p>Stimulus</p></td>
<td><p>The client is requested to send a CoAP GET request, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td><p>2</p></td>
<td><p>Check</p></td>
<td><p>Server parses the request and finds an unrecognized option of class &quot;critical&quot; (the object-security option)</p></td>
</tr>
<tr class="odd">
<td><p>3</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the received packet</p></td>
</tr>
<tr class="even">
<td><p>4</p></td>
<td><p>Check</p></td>
<td><p>Server serialize the response correctly, which is: 4.02 Bad Option error response, with:</p>
<ul>
<li>Payload = diagnostic payload (optional)</li>
</ul></td>
</tr>
<tr class="odd">
<td><p>5</p></td>
<td><p>Verify</p></td>
<td><p>Server displays the sent packet</p></td>
</tr>
</tbody>
</table>
